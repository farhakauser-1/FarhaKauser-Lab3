{"ast":null,"code":"import _regeneratorRuntime from \"/Users/farha/Downloads/GraphQL/GraphQL/frontend/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/farha/Downloads/GraphQL/GraphQL/frontend/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toArray from \"/Users/farha/Downloads/GraphQL/GraphQL/frontend/node_modules/@babel/runtime/helpers/esm/toArray\";\nimport _classCallCheck from \"/Users/farha/Downloads/GraphQL/GraphQL/frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/farha/Downloads/GraphQL/GraphQL/frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/farha/Downloads/GraphQL/GraphQL/frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/farha/Downloads/GraphQL/GraphQL/frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/farha/Downloads/GraphQL/GraphQL/frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _assertThisInitialized from \"/Users/farha/Downloads/GraphQL/GraphQL/frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nvar _jsxFileName = \"/Users/farha/Downloads/GraphQL/GraphQL/frontend/src/components/Search.js\";\nimport React, { Component } from 'react'; // import \"../../App.css\";\n// import axios from 'axios'\n// import cookie from 'react-cookies'\n\nimport { Redirect } from 'react-router';\nimport { withApollo } from 'react-apollo'; // import { ROOT_URL } from '../../URL'\n\nimport { menusearch } from '../queries/queries';\n\nvar Search =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Search, _Component);\n\n  function Search(props) {\n    var _this;\n\n    _classCallCheck(this, Search);\n\n    // Call the constrictor of Super class i.e The Component\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Search).call(this, props)); // maintain the state required for this component\n\n    _this.calculate = function (e) {\n      console.log(e.target.newVal);\n      var arrayMAin = _this.state.ITEMLIST;\n      console.log(arrayMAin);\n\n      var _e$target$id$split = e.target.id.split(','),\n          _e$target$id$split2 = _toArray(_e$target$id$split),\n          x = _e$target$id$split2.slice(0);\n\n      console.log(x[0] + 'targetid');\n      console.log('In Calculate');\n\n      for (var s in arrayMAin) {\n        console.log('In array main' + arrayMAin[s].Section + x[0]);\n\n        if (arrayMAin[s].Section == x[0]) {\n          var arrayOb = arrayMAin[s].items;\n\n          for (var i in arrayOb) {\n            if (arrayOb[i].item === x[1]) {\n              console.log(arrayOb[i]);\n              arrayOb[i].count = e.target.value;\n              console.log('Index found' + i);\n              console.log(e.target.value);\n            }\n\n            arrayMAin[s].items = arrayOb;\n          }\n        }\n      }\n\n      _this.setState({\n        ITEMLIST: arrayMAin\n      });\n      /* var index1 = this.state.ITEMLIST.indexOf(\n        this.state.ITEMLIST.filter(i => i.itemname === x)\n      )\n      console.log(index1) */\n\n    };\n\n    _this.addtocart = function (e) {\n      e.preventDefault();\n      var arraymain = _this.state.ITEMLIST;\n      var total = 0;\n\n      for (var k in arraymain) {\n        var arraycalc = arraymain[k].items;\n\n        for (var i = 0; i < arraycalc.length; i++) {\n          total += arraycalc[i].cost * arraycalc[i].count;\n        }\n      }\n\n      console.log(total);\n\n      _this.setState({\n        total: total\n      });\n\n      if (_this.state.total > 0) {\n        _this.setState({\n          enableorder: 'true'\n        });\n\n        console.log(_this.state.enableorder);\n      } else {\n        _this.setState({\n          enableorder: 'false'\n        });\n      }\n    };\n\n    _this.placeorder = function (e) {\n      e.preventDefault();\n      console.log('creating order');\n      var test = _this.state.ITEMLIST;\n      var cart = [];\n\n      for (var i in test) {\n        for (var j in test[i].items) {\n          console.log(test[i].items);\n          if (test[i].items[j].count > 0) cart.push(test[i].items[j]);\n        }\n      }\n\n      console.log(cart);\n      localStorage.setItem('cart', cart);\n      var data = {\n        username: localStorage.getItem('username'),\n        RestaurantName: localStorage.getItem('SelectedRestaurant'),\n        cart: JSON.stringify(cart)\n      };\n      console.log(data); // axios\n      //   .post(`${ROOT_URL}/createorder/`, data, {\n      //     headers: { Authorization: `Bearer ${localStorage.getItem('JWT')}` }\n      //   })\n      //   .then(response => {\n      //     console.log(response.data + 'here')\n      //     this.props.history.replace('/buyer/orderplaced')\n      //   })\n      //   .catch(() => {\n      //     console.log('Hello')\n      //     this.props.history.push('/buyer/login')\n      //   })\n    };\n\n    _this.insert = function (e) {\n      console.log('leaving');\n      localStorage.setItem('cart', JSON.stringify(_this.state.ITEMLIST));\n      var arraysave = _this.state.ITEMLIST;\n\n      for (var i = 0; i < arraysave.length; i++) {\n        if (arraysave[i].count != 0) {\n          var data = {\n            orderid: localStorage.getItem('orderid'),\n            itemname: arraysave[i].itemname,\n            quantity: arraysave[i].count // axios\n            //   .post(`${ROOT_URL}/insertorder/`, data, {\n            //     headers: { Authorization: `Bearer ${localStorage.getItem('JWT')}` }\n            //   })\n            //   .then(response => {\n            //     console.log(i)\n            //     console.log(response.data)\n            //   })\n            //   .catch(() => {\n            //     console.log('Hello')\n            //     this.props.history.push('/buyer/login')\n            //   })\n\n          };\n        }\n      }\n\n      _this.props.history.replace('/buyer/orderplaced');\n    };\n\n    _this.state = {\n      item: 'Tacos',\n      nameOfRestaurant: localStorage.getItem('SelectedRestaurant'),\n      ITEMLIST: [],\n      total: 0 // Bind the handlers to this class\n\n    };\n    _this.calculate = _this.calculate.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.addtocart = _this.addtocart.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.placeorder = _this.placeorder.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    _this.insert = _this.insert.bind(_assertThisInitialized(_assertThisInitialized(_this)));\n    return _this;\n  }\n\n  _createClass(Search, [{\n    key: \"componentWillUnmount\",\n    value: function () {\n      var _componentWillUnmount = _asyncToGenerator(\n      /*#__PURE__*/\n      _regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                console.log('leaving');\n                localStorage.setItem('cart', JSON.stringify(this.state.ITEMLIST));\n\n              case 2:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      return function componentWillUnmount() {\n        return _componentWillUnmount.apply(this, arguments);\n      };\n    }()\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      var _this2 = this;\n\n      var x = [];\n      console.log(this.state.nameOfRestaurant);\n      this.props.client.query({\n        query: menusearch,\n        variables: {\n          item: this.state.item,\n          email: localStorage.getItem('name')\n        }\n      }).then(function (response) {\n        if (response.data.login) {\n          console.log(JSON.stringify(response.data.login));\n        } else {\n          _this2.setState({\n            ITEMLIST: response.data.menusearch\n          });\n        }\n      }); // axios\n      //   .get(`${ROOT_URL}/fetchitems/${this.state.nameOfRestaurant}`, {\n      //     headers: { Authorization: `Bearer ${localStorage.getItem('JWT')}` }\n      //   })\n      //   .then(response => {\n      //     console.log('Onclick')\n      //     console.log(response.data)\n      //     this.setState({ ITEMLIST: response.data })\n      //     /* var y = response.data.length;\n      //     for (let i = 0; i < y; i++) x.push(JSON.stringify(response.data[i])); */\n      //   })\n      //   .catch(() => {\n      //     console.log('Hello')\n      //     this.props.history.push('/buyer/login')\n      //   })\n\n      console.log('state' + this.state.ITEMLIST);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this3 = this;\n\n      return React.createElement(\"div\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178\n        },\n        __self: this\n      }, React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        class: \"card text-center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        className: \"btn-danger m-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181\n        },\n        __self: this\n      }, localStorage.getItem('SelectedRestaurant'), \" RESTAURANT\")), React.createElement(\"table\", {\n        class: \"table\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185\n        },\n        __self: this\n      }, this.state.ITEMLIST.map(function (sec) {\n        return React.createElement(\"tr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 187\n          },\n          __self: this\n        }, React.createElement(\"td\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 188\n          },\n          __self: this\n        }, sec.Section), React.createElement(\"thead\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 189\n          },\n          __self: this\n        }, React.createElement(\"tr\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 190\n          },\n          __self: this\n        }, React.createElement(\"th\", {\n          scope: \"Restaurant\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 191\n          },\n          __self: this\n        }, \"ITEMS\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 192\n          },\n          __self: this\n        }, \"DESCRIPTION \"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 193\n          },\n          __self: this\n        }, \"PRICE \"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 194\n          },\n          __self: this\n        }, \"QUANTITY\"), React.createElement(\"th\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 195\n          },\n          __self: this\n        }, \"COST\"))), React.createElement(\"tbody\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 198\n          },\n          __self: this\n        }, sec.items.map(function (it) {\n          return React.createElement(\"tr\", {\n            key: it.item,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 200\n            },\n            __self: this\n          }, React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 201\n            },\n            __self: this\n          }, it.item), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 202\n            },\n            __self: this\n          }, it.description), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 203\n            },\n            __self: this\n          }, it.cost), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 204\n            },\n            __self: this\n          }, React.createElement(\"input\", {\n            id: [sec.Section, it.item],\n            type: \"number\",\n            min: \"0\",\n            max: \"10\",\n            newVal: \"0\",\n            onChange: _this3.calculate,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 205\n            },\n            __self: this\n          })), React.createElement(\"td\", {\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 214\n            },\n            __self: this\n          }, it.count * it.cost));\n        })));\n      })), React.createElement(\"div\", {\n        align: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 221\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"btn btn-success m-2\",\n        onClick: this.addtocart,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 222\n        },\n        __self: this\n      }, \"GET AMOUNT FOR ALL ITEMS\"), React.createElement(\"span\", {\n        className: \"btn  m-2\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226\n        },\n        __self: this\n      }, \"AMOUNT PAYABLE: \", this.state.total)), React.createElement(\"div\", {\n        align: \"center\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 228\n        },\n        __self: this\n      }, React.createElement(\"button\", {\n        className: \"btn btn-danger m-2\",\n        onClick: this.placeorder,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 229\n        },\n        __self: this\n      }, \"ADD TO CART\"))));\n    }\n  }]);\n\n  return Search;\n}(Component);\n\nexport default withApollo(Search);","map":{"version":3,"sources":["/Users/farha/Downloads/GraphQL/GraphQL/frontend/src/components/Search.js"],"names":["React","Component","Redirect","withApollo","menusearch","Search","props","calculate","e","console","log","target","newVal","arrayMAin","state","ITEMLIST","id","split","x","s","Section","arrayOb","items","i","item","count","value","setState","addtocart","preventDefault","arraymain","total","k","arraycalc","length","cost","enableorder","placeorder","test","cart","j","push","localStorage","setItem","data","username","getItem","RestaurantName","JSON","stringify","insert","arraysave","orderid","itemname","quantity","history","replace","nameOfRestaurant","bind","client","query","variables","email","then","response","login","map","sec","it","description"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\n// import \"../../App.css\";\n// import axios from 'axios'\n// import cookie from 'react-cookies'\nimport { Redirect } from 'react-router'\nimport { withApollo } from 'react-apollo'\n// import { ROOT_URL } from '../../URL'\nimport { menusearch } from '../queries/queries'\n\nclass Search extends Component {\n  constructor (props) {\n    // Call the constrictor of Super class i.e The Component\n    super(props)\n    // maintain the state required for this component\n    this.state = {\n      item: 'Tacos',\n      nameOfRestaurant: localStorage.getItem('SelectedRestaurant'),\n      ITEMLIST: [],\n      total: 0\n    }\n    // Bind the handlers to this class\n    this.calculate = this.calculate.bind(this)\n    this.addtocart = this.addtocart.bind(this)\n    this.placeorder = this.placeorder.bind(this)\n    this.insert = this.insert.bind(this)\n  }\n  async componentWillUnmount () {\n    console.log('leaving')\n    localStorage.setItem('cart', JSON.stringify(this.state.ITEMLIST))\n  }\n  componentDidMount () {\n    var x = []\n    console.log(this.state.nameOfRestaurant)\n    this.props.client\n      .query({\n        query: menusearch,\n        variables: {\n          item: this.state.item,\n          email: localStorage.getItem('name')\n        }\n      })\n      .then(response => {\n        if (response.data.login) {\n          console.log(JSON.stringify(response.data.login))\n        } else {\n          this.setState({ ITEMLIST: response.data.menusearch })\n        }\n      })\n    // axios\n    //   .get(`${ROOT_URL}/fetchitems/${this.state.nameOfRestaurant}`, {\n    //     headers: { Authorization: `Bearer ${localStorage.getItem('JWT')}` }\n    //   })\n    //   .then(response => {\n    //     console.log('Onclick')\n    //     console.log(response.data)\n    //     this.setState({ ITEMLIST: response.data })\n    //     /* var y = response.data.length;\n    //     for (let i = 0; i < y; i++) x.push(JSON.stringify(response.data[i])); */\n    //   })\n    //   .catch(() => {\n    //     console.log('Hello')\n    //     this.props.history.push('/buyer/login')\n    //   })\n\n    console.log('state' + this.state.ITEMLIST)\n  }\n  calculate = e => {\n    console.log(e.target.newVal)\n    var arrayMAin = this.state.ITEMLIST\n    console.log(arrayMAin)\n\n    var [...x] = e.target.id.split(',')\n    console.log(x[0] + 'targetid')\n    console.log('In Calculate')\n    for (var s in arrayMAin) {\n      console.log('In array main' + arrayMAin[s].Section + x[0])\n      if (arrayMAin[s].Section == x[0]) {\n        var arrayOb = arrayMAin[s].items\n\n        for (var i in arrayOb) {\n          if (arrayOb[i].item === x[1]) {\n            console.log(arrayOb[i])\n            arrayOb[i].count = e.target.value\n            console.log('Index found' + i)\n            console.log(e.target.value)\n          }\n          arrayMAin[s].items = arrayOb\n        }\n      }\n    }\n\n    this.setState({ ITEMLIST: arrayMAin })\n    /* var index1 = this.state.ITEMLIST.indexOf(\n      this.state.ITEMLIST.filter(i => i.itemname === x)\n    )\n    console.log(index1) */\n  }\n  addtocart = e => {\n    e.preventDefault()\n    var arraymain = this.state.ITEMLIST\n    let total = 0\n    for (var k in arraymain) {\n      var arraycalc = arraymain[k].items\n      for (let i = 0; i < arraycalc.length; i++) {\n        total += arraycalc[i].cost * arraycalc[i].count\n      }\n    }\n    console.log(total)\n    this.setState({ total })\n    if (this.state.total > 0) {\n      this.setState({ enableorder: 'true' })\n      console.log(this.state.enableorder)\n    } else {\n      this.setState({ enableorder: 'false' })\n    }\n  }\n  placeorder = e => {\n    e.preventDefault()\n    console.log('creating order')\n    var test = this.state.ITEMLIST\n    var cart = []\n    for (var i in test) {\n      for (var j in test[i].items) {\n        console.log(test[i].items)\n        if (test[i].items[j].count > 0) cart.push(test[i].items[j])\n      }\n    }\n    console.log(cart)\n    localStorage.setItem('cart', cart)\n    const data = {\n      username: localStorage.getItem('username'),\n      RestaurantName: localStorage.getItem('SelectedRestaurant'),\n      cart: JSON.stringify(cart)\n    }\n    console.log(data)\n    // axios\n    //   .post(`${ROOT_URL}/createorder/`, data, {\n    //     headers: { Authorization: `Bearer ${localStorage.getItem('JWT')}` }\n    //   })\n    //   .then(response => {\n    //     console.log(response.data + 'here')\n    //     this.props.history.replace('/buyer/orderplaced')\n    //   })\n    //   .catch(() => {\n    //     console.log('Hello')\n    //     this.props.history.push('/buyer/login')\n    //   })\n  }\n  insert = e => {\n    console.log('leaving')\n    localStorage.setItem('cart', JSON.stringify(this.state.ITEMLIST))\n    var arraysave = this.state.ITEMLIST\n    for (let i = 0; i < arraysave.length; i++) {\n      if (arraysave[i].count != 0) {\n        let data = {\n          orderid: localStorage.getItem('orderid'),\n          itemname: arraysave[i].itemname,\n          quantity: arraysave[i].count\n        }\n        // axios\n        //   .post(`${ROOT_URL}/insertorder/`, data, {\n        //     headers: { Authorization: `Bearer ${localStorage.getItem('JWT')}` }\n        //   })\n        //   .then(response => {\n        //     console.log(i)\n        //     console.log(response.data)\n        //   })\n        //   .catch(() => {\n        //     console.log('Hello')\n        //     this.props.history.push('/buyer/login')\n        //   })\n      }\n    }\n    this.props.history.replace('/buyer/orderplaced')\n  }\n  render () {\n    return (\n      <div>\n        <form>\n          <div class='card text-center'>\n            <h1 className='btn-danger m-2'>\n              {localStorage.getItem('SelectedRestaurant')} RESTAURANT\n            </h1>\n          </div>\n          <table class='table'>\n            {this.state.ITEMLIST.map(sec => (\n              <tr>\n                <td>{sec.Section}</td>\n                <thead>\n                  <tr>\n                    <th scope='Restaurant'>ITEMS</th>\n                    <th>DESCRIPTION </th>\n                    <th>PRICE </th>\n                    <th>QUANTITY</th>\n                    <th>COST</th>\n                  </tr>\n                </thead>\n                <tbody>\n                  {sec.items.map(it => (\n                    <tr key={it.item}>\n                      <td>{it.item}</td>\n                      <td>{it.description}</td>\n                      <td>{it.cost}</td>\n                      <td>\n                        <input\n                          id={[sec.Section, it.item]}\n                          type='number'\n                          min='0'\n                          max='10'\n                          newVal='0'\n                          onChange={this.calculate}\n                        />\n                      </td>\n                      <td>{it.count * it.cost}</td>\n                    </tr>\n                  ))}\n                </tbody>\n              </tr>\n            ))}\n          </table>\n          <div align='center'>\n            <button className='btn btn-success m-2' onClick={this.addtocart}>\n              GET AMOUNT FOR ALL ITEMS\n            </button>\n\n            <span className='btn  m-2'>AMOUNT PAYABLE: {this.state.total}</span>\n          </div>\n          <div align='center'>\n            <button className='btn btn-danger m-2' onClick={this.placeorder}>\n              ADD TO CART\n            </button>\n          </div>\n        </form>\n      </div>\n    )\n  }\n}\nexport default withApollo(Search)\n"]},"metadata":{},"sourceType":"module"}